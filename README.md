# Holiday Todo App

勤務表（.ics）に基づいて休日にタスクを自動スケジューリングするPWA対応Todoアプリです。

## 特徴

- **勤務表読込**: Googleカレンダー等からの .ics ファイル読込（夜勤/日勤/休み）
- **自動スケジューリング**: 休日に優先度順でタスクを自動割り当て
- **Discord通知**: 前日夜およびタスク開始前にDiscordへ通知
- **PWA対応**: インストールしてオフラインでも利用可能（通知は制限あり）
- **プライバシー**: データは全て端末内（IndexedDB）に保存

## 使い方

### 1. 初期設定

1. アプリを開く
2. 「設定」タブに移動
3. **カレンダー読み込み**: 勤務表の `.ics` ファイルを選択してアップロード
   - イベント名の命名規則: "夜勤", "日勤", "休み"
4. **Discord 通知設定**: 下記手順でWebhook URLを作成し入力

### 2. タスク管理

1. 「タスク」タブでやりたいことを入力
2. 優先度（1〜5）を設定して追加
3. タスクはプールされ、休日に自動的に割り当てられます

### 3. スケジュール確認

1. 「カレンダー」タブで予定を確認
2. 休日の枠内にスケジューリングされたタスクが表示されます

---

## Discord Webhook 設定手順

### 1. Webhookの作成

1. Discordを開き、通知を受け取りたい**サーバー**に移動
2. サーバー名をクリック → **「サーバー設定」**
3. 左メニューから**「連携サービス」** → **「ウェブフック」**
4. **「新しいウェブフック」**をクリック
5. 名前（例: "Holiday Todo"）とアイコンを設定
6. 通知を送りたい**チャンネル**を選択
7. **「ウェブフックURLをコピー」**をクリック

### 2. アプリへの設定

1. 本アプリの「設定」タブを開く
2. **Webhook URL** の入力欄にコピーしたURLを貼り付け
3. **「通知テスト」**ボタンをクリックして動作確認
4. Discordにテストメッセージが届けば成功

### 通知タイミング

| タイミング       | 説明                               |
| ---------------- | ---------------------------------- |
| 前日夜 21:00     | 翌日が休日の場合、タスク一覧を通知 |
| タスク開始30分前 | 各タスクの開始直前に個別通知       |

> **注意**: 通知はアプリがブラウザで開いている間のみ動作します。バックグラウンド通知にはサーバーが必要です。

---

## Googleカレンダーからのエクスポート

1. [Googleカレンダー](https://calendar.google.com/) を開く
2. 右上の**歯車アイコン** → **「設定」**
3. 左メニューから対象カレンダーを選択
4. **「カレンダーをエクスポート」**をクリック
5. ダウンロードされた `.ics` ファイルを本アプリで読み込む

---

## 開発・ビルド

### 開発サーバー起動
```bash
npm install
npm run dev
```

### プロダクションビルド
```bash
npm run build
npm run preview
```

---

## サンプルデータ

`public/sample-schedule.ics` にテスト用の勤務表が含まれています。

### イベント名の命名規則

| イベント名 | 意味                                           |
| ---------- | ---------------------------------------------- |
| 夜勤       | 夜間勤務（終了時刻が翌日午前になることが多い） |
| 日勤       | 日中勤務                                       |
| 休み       | 休日                                           |

### スケジューリングルール

- 休日判定: 当日に「休み」イベントがある、またはイベントがない場合
- 開始時刻:
  - 前日終業が12:00未満 → 13:00開始
  - 前日終業が12:00以上 → 08:00開始
- 2時間おきに最大3タスクを割り当て
- 優先度5（高）から順に割り当て
