# Holiday Todo App

勤務表（.ics）に基づいて、休日にタスクを自動でスマートにスケジューリングする Todo アプリケーションです。
不規則なシフト勤務の方でも、「次の休みにやること」を効率的に管理・消化できるよう設計されています。

## 🎯 開発目的

1. **AIエージェントの実験**: Google製のAIエージェント搭載エディタ「Antigravity」を使えば、簡単にWebアプリを作成できるか検証するため。
2. **タスクスケジュール自動化**: 知人が普段手動で行っている休日タスクのスケジュール作成を、自動化して楽にするため。

## ⚠️ Googleログインに関する注意

現在、Google Calendar APIは**本番環境での認証審査を受けていません**。そのため、Googleアカウントでログインするには**事前にテストユーザーとして登録**が必要です。

利用を希望される方は、以下の手順でお知らせください：
1. 使用するGmailアドレスを開発者に連絡
2. テストユーザーとして登録後、ログインが可能になります

※ゲストログインはアカウント登録なしで利用可能です。
## ✨ 特徴

- **スマートスケジューリング**:
    - 優先度（P1〜P5）の高いタスクから順に、次の休日に自動で割り当てられます。
    - 1日のタスク数上限や開始時間を生活リズムに合わせて設定可能。
- **繰り返しタスク**:
    - 毎日/毎週/隔週/毎月/毎年の繰り返しに対応。
    - 毎週・隔週では複数曜日を選択可能。
    - 個別削除対応（その回だけ削除、今後の予定は残る）。
- **勤務表連携**:
    - Googleカレンダー連携またはICSファイル読み込みに対応。
    - 「夜勤」「日勤」「休み」を自動判定。
- **カレンダーからのタスク管理**:
    - 日付タップで詳細表示、その場でタスクの追加・編集・削除が可能。
- **ゲストログイン**:
    - アカウント登録なしでアプリを試用可能。
    - ブラウザセッション終了までデータを保持。
- **クラウド同期 (Supabase)**:
    - Googleアカウントでログインし、PC・スマホ間でデータを同期。
- **Discord通知**:
    - 休日の前日夜や、タスク開始直前にDiscordへリマインド通知を送信。
- **ダークモード**:
    - ライト/ダーク/システム設定に対応。
- **PWA対応**:
    - アプリとしてインストール可能。

## 🛠 技術スタック

- **Frontend**: React 19 (TypeScript), Vite
- **Backend/DB**: Supabase (Auth, PostgreSQL, Realtime)
- **State Management**: TanStack React Query
- **Date Handling**: date-fns
- **Deployment**: Vercel
- **Styling**: Vanilla CSS (with CSS variables & dark mode)

## 🚀 始め方 (開発者向け)

### 1. リポジトリのクローン
```bash
git clone https://github.com/RyoyaYahagi/todo.git
cd todo
npm install
```

### 2. 環境変数の設定
`.env.local` ファイルを作成し、Supabaseのプロジェクト情報を設定します。

```env
VITE_SUPABASE_URL=your_supabase_project_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 3. Supabase設定
- **匿名認証の有効化**: Authentication → Providers → Anonymous Sign-ins → Enable
- **Google OAuth設定**: Authentication → Providers → Google → Enable

### 4. 開発サーバー起動
```bash
npm run dev
```

### 5. ビルド
```bash
npm run build
```

### 6. テスト
```bash
npm test
```

## 📱 使い方

1. **ログイン**: 
   - Googleアカウントでサインイン、または
   - 「ゲストとして試す」でアカウント登録なしに利用
2. **初期設定 (チュートリアル)**:
   - アプリの基本操作ガイドが表示されます。
3. **カレンダー読込**:
   - 「設定」タブ → 「Googleカレンダーから同期」または「.icsファイルを選択」。
   - イベント名に「夜勤」「日勤」「休み」を含むイベントが自動解析されます。
4. **タスク追加**:
   - 右下の「＋」ボタンからタスクを追加。
   - カレンダーの日付タップ → 「+ タスクを追加」でその日にタスクを追加。
5. **繰り返しタスク**:
   - 「🕐 指定」タブ → 「🔁 繰り返す」をオン → 繰り返し頻度を選択。
   - 「毎週」「隔週」選択時は、複数曜日を選択可能。
6. **通知設定**:
   - Discord Webhook URLを設定すると、リマインダーを受け取れます。

## 📋 スケジューリングロジック

- **優先度順**: P5 (最高) 〜 P1 (最低) の順にスロットを確保。
- **休日判定**: 「休み」イベントがある日、またはイベントがない日を休日とみなします。
- **開始時間**:
    - 前日が「夜勤」の場合 → 夜勤明けタスク開始時間を使用
    - それ以外 → 日勤後タスク開始時間を使用
    - ※設定画面でカスタマイズ可能（0:00〜23:00）

## 🛡️ セキュリティ

- **RLS (Row Level Security)**: Supabase側で、ログインユーザー自身のデータにのみアクセスできるよう制限されています。
- **認証**: Supabase Auth (Google OAuth / Anonymous) を使用。

---

© 2025 RyoyaYahagi
